<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />

    <meta property="og:type" content="music.radio_station">
    <meta property="og:title" content="Thaalam Podcast">
    <meta property="og:description" content="Listen to the latest Tamil podcasts on Thaalam.">
    <meta property="og:image" content="https://thaalam.ch/img/podcast-banner2.jpg">
    <meta property="og:url" content="">

    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Thaalam Podcast">
    <meta name="twitter:description" content="Listen to the latest Tamil podcasts on Thaalam.">
    <meta name="twitter:image" content="https://thaalam.ch/img/podcast-banner2.jpg">


    <!-- CSS -->
    <link rel="stylesheet" href="css/bootstrap-reboot.min.css" />
    <link rel="stylesheet" href="css/bootstrap-grid.min.css" />
    <link rel="stylesheet" href="css/owl.carousel.min.css" />
    <link rel="stylesheet" href="css/magnific-popup.css" />
    <link rel="stylesheet" href="css/select2.min.css" />
    <link rel="stylesheet" href="css/plyr.css" />
    <link rel="stylesheet" href="css/main.css" />
    <link rel="stylesheet" href="css/style.css" />
    <link rel="stylesheet" href="css/podcast.css" />
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <!-- Favicons -->
    <link rel="icon" type="image/png" href="icon/favicon.png" sizes="32x32" />
    <title>Thaalam - Podcast</title>
    <meta name="robots" content="noindex" />
    <style>
        .select2-container {
            width: 100% !important;
            background: #ffffff;
            padding: 10px;
            border: 1px solid;
        }

        .mfp-iframe-holder .mfp-content {
            height: 100% !important;
        }

        .mfp-container {
            padding: 40px 15px !important;
        }

        a {
            text-decoration: none;
        }
    </style>



    <!-- Google Tag Manager -->
    <script>(function (w, d, s, l, i) {
            w[l] = w[l] || []; w[l].push({
                'gtm.start':
                    new Date().getTime(), event: 'gtm.js'
            }); var f = d.getElementsByTagName(s)[0],
                j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : ''; j.async = true; j.src =
                    'https://www.googletagmanager.com/gtm.js?id=' + i + dl; f.parentNode.insertBefore(j, f);
        })(window, document, 'script', 'dataLayer', 'GTM-KLC938NV');</script>
    <!-- End Google Tag Manager -->



</head>

<body style="background: url('img/background.jpg'); background-size: cover">

    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KLC938NV" height="0" width="0"
            style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->
    <!-- header -->
    <!-- header -->
    <!-- header -->

    <header class="header">

        <div class="header__content">
            <div class="header__logo">
                <a href="./">
                    <img src="img/thalam-logo.png" alt="" />
                </a>
            </div>

            <div id="commonnavbar" style="margin-right:10px;  text-align: end;"></div>

            <script>

            </script>

            <!-- <div id="commonnavbar2"  style="  text-align: end;"></div> -->

            <div class="header__action header__action--signin" style="width:55%;    margin-right: 30px;"
                id="commonnavbar3"></div>
            <!-- <div class="header__action-btn" style="width:75%;    margin-right: 35px;">
        <a class="header__action-btn" href="signin">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12,2A10,10,0,0,0,4.65,18.76h0a10,10,0,0,0,14.7,0h0A10,10,0,0,0,12,2Zm0,18a8,8,0,0,1-5.55-2.25,6,6,0,0,1,11.1,0A8,8,0,0,1,12,20ZM10,10a2,2,0,1,1,2,2A2,2,0,0,1,10,10Zm8.91,6A8,8,0,0,0,15,12.62a4,4,0,1,0-6,0A8,8,0,0,0,5.09,16,7.92,7.92,0,0,1,4,12a8,8,0,0,1,16,0A7.92,7.92,0,0,1,18.91,16Z"></path></svg>
        </a>
      </div>
      <div id="commonnavbar3"></div> -->

            <a href="./contact">
                <div class="phone-number phone-number--below">
                    <img class="fa" src="icon/phone.png" />
                    <span style="color: #f60001">Reach Us</span> <br />
                    <span style="font-weight: initial">+41 79 288 22 71</span>
                </div>
            </a>
            <button class="header__btn" type="button">
                <span></span>
                <span></span>
                <span></span>
            </button>
        </div>
    </header>

    <div class="sidebar" style="background: url('img/background.jpg'); background-size: cover">
        <!-- sidebar logo -->
        <div class="sidebar__logo">
            <a href="./"><img src="img/thalam-logo.png" alt="" /></a>
        </div>
        <!-- end sidebar logo -->

        <!-- sidebar nav -->
        <ul class="sidebar__nav" id="menucontent1">

        </ul>
        <!-- end sidebar nav -->
    </div>

    <main class="main">
        <div class="container">
            <div class="podcast-details">

                <div class="podcast-details-layout"> <!-- this flex layout container -->

                    <div class="podcast-details-left"> <!-- left side -->

                        <!-- Podcast Image -->
                        <div class="podcast-details__image">
                            <img src="img/podcast-banner2.jpg" alt="Podcast Cover" oncontextmenu="return false;" />
                        </div>

                        <!-- Title -->
                        <h1 id="podcastTitle" class="podcast-details__title"></h1>

                        <!-- Meta Info -->
                        <div class="podcast-details__meta">
                            <div><i class="fas fa-user"></i><span id="rjName"></span></div>
                            <div><i class="fas fa-calendar-alt"></i> <span id="publishedDate"></span></div>
                            <!-- <div><i class="fas fa-clock"></i> <span id="duration"></span></div> -->
                        </div>

                        <!-- Description -->
                        <div id="podcastDescription" class="podcast-details__description"></div>

                        <!-- Audio Player -->
                        <div class="podcast-details__audio">
                            <div class="custom-audio-player">
                                <div class="controls">
                                    <button id="playPauseBtn" class="play-pause-btn">
                                        <i class="fas fa-play"></i>
                                    </button>
                                    <div class="time" id="currentTime">0:00</div>
                                    <div class="progress-bar" id="progressBar">
                                        <div class="progress" id="progress"></div>
                                    </div>
                                    <div class="time" id="totalDuration">0:00</div>
                                </div>
                            </div>
                            <audio id="audioPlayer">
                                <source id="audioSource" src="" type="audio/mpeg" />
                                Your browser does not support the audio element.
                            </audio>
                        </div>

                        <!-- Tags -->
                        <div class="podcast-details__bottom">
                            <div class="podcast-details__tags">
                                <p>Tags: </p>
                                <span id="podcastTags"></span>
                            </div>

                            <!-- Share -->
                            <div class="podcast-details__share">
                                <p>Share: </p>
                                <a id="fb-share" target="_blank"><i class="fab fa-facebook-f"></i></a>
                                <a id="x-share" target="_blank">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                                        viewBox="0 0 24 24">
                                        <path
                                            d="M20.75 3h-3.43L12 9.35 6.68 3H3l7.47 8.43L3 21h3.43L12 14.65 17.32 21H21l-7.47-8.57L20.75 3z" />
                                    </svg>
                                </a>
                                <a id="tiktok-share" target="_blank"><i class="fab fa-tiktok"></i></a>
                                <a id="insta-share" target="_blank"><i class="fab fa-instagram"></i></a>
                                <a id="whatsapp-share" target="_blank"><i class="fab fa-whatsapp"></i></a>
                                <a href="#" onclick="copyLink(); return false;"><i class="fas fa-link"></i></a>
                            </div>

                        </div>


                    </div> <!-- end left -->

                    <div class="podcast-details-right"> <!-- right side -->
                        <h4 class="related-title">More by <span id="relatedRJ"></span></h4>
                        <div id="relatedPodcasts" class="related-podcast-list"></div>
                    </div>

                </div> <!-- end layout -->

            </div>
        </div>
    </main>

    <div id="commonfooter"></div>

    <script src="js/jquery-3.5.1.min.js"></script>
    <script src="js/bootstrap.bundle.min.js"></script>
    <script src="js/owl.carousel.min.js"></script>
    <script src="js/jquery.magnific-popup.min.js"></script>
    <script src="js/select2.min.js"></script>
    <script src="js/jquery.inputmask.min.js"></script>
    <script src="js/plyr.min.js"></script>
    <script src="js/main.js"></script>
    <script type="text/javascript" src="js/menu.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/toastify-js"></script>

    <script>
        function copyLink() {
            navigator.clipboard.writeText(currentURL).then(() => {
                successToast("Link Copied successfully");
            });
        }


        $(function () {
            $("#commonheader").load("./header");
            $("#commonfooter").load("./footer");
            menucontent();
            setTimeout(() => {
                SetLogin1();
                SetLogout();
            }, 1000);
        });

        const queryString = window.location.search;
        const urlParams = new URLSearchParams(queryString);
        const podcastId = urlParams.get("id");

        const currentURL = window.location.href;

        if (podcastId) {
            fetch(`https://api.demoview.ch/api/podcasts/${podcastId}`)
                .then(res => res.json())
                .then(result => {
                    const data = result.podcast;
                    if (data) {
                        // document.getElementById("podcastImage").src = `https://api.demoview.ch/api/${data.image_url.replace(/\\/g, "/")}`;
                        document.getElementById("podcastTitle").textContent = data.title;
                        document.getElementById("rjName").textContent = data.rjname;
                        document.getElementById("publishedDate").textContent = new Date(data.date).toLocaleDateString('en-US', {
                            year: 'numeric', month: 'short', day: 'numeric'
                        });
                        // document.getElementById("duration").textContent = data.duration || 'N/A';
                        document.getElementById("podcastDescription").textContent = data.description;

                        if (data.audio_drive_file_id) {
                            document.getElementById("audioSource").src = `https://api.demoview.ch/api/podcasts/stream-audio/${data.audio_drive_file_id}`;
                            document.getElementById("audioPlayer").load();
                        }

                        document.getElementById("podcastTags").innerHTML = Array.isArray(data.tags)
                            ? data.tags.map(tag => `<span>${tag}</span>`).join(' ')
                            : '';

                        fetchRelatedPodcasts(data.rjname, data.id);
                        updateMetaTags(data);


                        document.getElementById("fb-share").href = `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(window.location.href)}`;
                        document.getElementById("x-share").href = `https://twitter.com/intent/tweet?url=${encodeURIComponent(window.location.href)}&text=${encodeURIComponent(data.title)}`;
                        document.getElementById("whatsapp-share").href = `https://api.whatsapp.com/send?text=${encodeURIComponent(window.location.href)}`;
                        document.getElementById("insta-share").href = `https://www.instagram.com/`;
                    } else {
                        console.warn("Podcast not found.");
                    }
                })
                .catch(err => console.error("Error fetching podcast:", err));
        }

        // Audio player controls
        const audioPlayer = document.getElementById("audioPlayer");
        const playPauseBtn = document.getElementById("playPauseBtn");
        const progressBar = document.getElementById("progressBar");
        const progress = document.getElementById("progress");
        const currentTimeEl = document.getElementById("currentTime");
        const totalDurationEl = document.getElementById("totalDuration");

        playPauseBtn.addEventListener("click", () => {
            if (audioPlayer.paused) {
                playPauseBtn.innerHTML = '<span class="audio-loading-spinner"></span>';
                if (audioPlayer.readyState >= 3) {
                    audioPlayer.play();
                } else {
                    audioPlayer.load();
                    audioPlayer.play();
                }
            } else {
                audioPlayer.pause();
                playPauseBtn.innerHTML = '<i class="fas fa-play"></i>';
            }
        });


        audioPlayer.addEventListener("playing", () => {
            playPauseBtn.innerHTML = '<i class="fas fa-pause"></i>';
        });

        audioPlayer.addEventListener("pause", () => {
            playPauseBtn.innerHTML = '<i class="fas fa-play"></i>';
        });

        audioPlayer.addEventListener("timeupdate", () => {
            const percentage = (audioPlayer.currentTime / audioPlayer.duration) * 100;
            progress.style.width = percentage + "%";

            currentTimeEl.textContent = formatTime(audioPlayer.currentTime);
            totalDurationEl.textContent = formatTime(audioPlayer.duration);
        });

        progressBar.addEventListener("click", (e) => {
            const rect = progressBar.getBoundingClientRect();
            const clickX = e.clientX - rect.left;
            const newTime = (clickX / rect.width) * audioPlayer.duration;
            audioPlayer.currentTime = newTime;
        });

        function formatTime(seconds) {
            const minutes = Math.floor(seconds / 60) || 0;
            const secs = Math.floor(seconds % 60) || 0;
            return `${minutes}:${secs < 10 ? "0" : ""}${secs}`;
        }

        function updateMetaTags(podcast) {
            // Update OG tags
            document.querySelector('meta[property="og:title"]').setAttribute("content", podcast.title);
            document.querySelector('meta[property="og:description"]').setAttribute("content", podcast.description);
            document.querySelector('meta[property="og:url"]').setAttribute("content", window.location.href);

            // Update Twitter tags
            document.querySelector('meta[name="twitter:title"]').setAttribute("content", podcast.title);
            document.querySelector('meta[name="twitter:description"]').setAttribute("content", podcast.description);
        }

        function fetchRelatedPodcasts(rjName, excludeId) {
            document.getElementById("relatedRJ").textContent = rjName;

            fetch(`https://api.demoview.ch/api/podcasts?page=1&search=${rjName}`)
                .then(res => res.json())
                .then(result => {
                    const container = document.getElementById("relatedPodcasts");
                    container.innerHTML = "";


                    if (result?.data?.data && result?.data?.data.length > 1) {
                        result.data.data.forEach(p => {
                            if (p.id === parseInt(excludeId)) return;

                            let formattedDate = new Date(p.date).toLocaleDateString('en-US', {
                                year: 'numeric', month: 'short', day: 'numeric'
                            });

                            const card = document.createElement("div");
                            card.className = "related-podcast-card";
                            card.innerHTML = `
                                  <div class="related-podcast-content">
                                    <div class="related-podcast__date">
                                        <i class="fas fa-calendar-alt"></i> <span> ${formattedDate}</span>
                                    </div>    
                                    <h5 class="related-podcast-title">${p.title}</h5>
                                    <div class="related-tags">
                                      ${Array.isArray(p.tags) ? p.tags.map(t => `<span>${t}</span>`).join(" ") : ''}
                                    </div>
                                  </div>`;
                            card.style.cursor = "pointer";
                            card.addEventListener("click", () => {
                                window.location.href = `podcast-details.html?id=${p.id}`;
                            });
                            container.appendChild(card);
                        });
                    } else {
                        container.innerHTML = `<p class="no-related__podcast">No other podcasts by ${rjName} found.</p>`;
                    }
                })
                .catch(error => {
                    console.error("Error fetching related podcasts:", error);
                });
        }

    </script>
</body>

</html>